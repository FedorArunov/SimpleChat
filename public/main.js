var Chat=function(){"use strict";var e=Object.freeze({});function t(e){return e&&e.default||e}t(Object.freeze({}));var n=function(e){this._container=e,this.render=this.render.bind(this)};n.prototype.constructor=n,n.prototype.render=function(e){this._container.innerHTML=e.map(function(e){var t=e.author,n=e.content;return['<div class="message-item">','<div class="message-time">',new Date(e.updated).toLocaleString(),"</div>",'<div class="message-author">',t,"</div>",'<div class="message-text">',n,"</div>","</div>"].join(" ")}).join("")};var i=n;t(Object.freeze({}));var s=function(e){this._container=e,this._container.classList.add("input-box"),this._container.innerHTML="<textarea></textarea>",this._container.querySelector("textarea").addEventListener("keydown",this.keyHandler.bind(this))};s.prototype.constructor=s,s.prototype.keyHandler=function(e){if("function"==typeof this.onSend&&13===e.keyCode&&!e.shiftKey){e.preventDefault();var t=this._container.querySelector("textarea");this.onSend(t.value),t.value=""}};var r=s;var o={get_messages:function(){return fetch("messages").then(function(e){return e.json()})},add_message:function(e,t){return fetch("messages",{method:"PUT",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({author:e,content:t})}).then(function(e){return e.json()})},add_user:function(e){return fetch("users",{method:"PUT",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({login:e})}).then(function(e){return e.json()})}};t(e);var a=function(e){this.refresh=this.refresh.bind(this),this.resize=this.resize.bind(this),this._container=e,this._container.innerHTML=['<div class="header"></div>','<div class="wrapper">','<div class="content">','<div class="messages"></div>','<div class="messages-input"></div>',"</div>",'<div class="sidebar">','<div class="sidebar-menu"></div>','<div class="sidebar-users"></div>',"</div>","</div>",'<div class="footer"></div>'].join(""),this._messages=new i(this._container.querySelector(".messages")),this._box=new r(this._container.querySelector(".messages-input")),this._box.onSend=this.addMessage.bind(this),window.addEventListener("resize",this.resize),this.refresh(),this.resize()};return a.prototype.constructor=a,a.prototype.refresh=function(){o.get_messages().then(this._messages.render).catch(function(e){console.log(e)})},a.prototype.resize=function(){var e=this._container.getBoundingClientRect().height,t=this._container.querySelector(".header").getBoundingClientRect().height,n=this._container.querySelector(".footer").getBoundingClientRect().height,i=this._container.querySelector(".messages-input").getBoundingClientRect().height,s="".concat(e-t-i-n,"px"),r=this._container.querySelector(".messages");r.style.maxHeight=s,r.style.height=s},a.prototype.addMessage=function(e){o.add_message(0,e).then(this.refresh).catch(function(e){console.log(e)})},new a(document.getElementById("app"))}();
//# sourceMappingURL=main.js.map
